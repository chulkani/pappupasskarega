<!--CREDIT CARD -->
<!-- content.html -->
<div class="container">
    <div id="formPart" class="row">
        <div class="col-md-12">
            <h1>Enter Details</h1>
            <div class="row mb-2">
                <div class="col-md-12">
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios1" value="option1">
                        <label class="form-check-label" for="exampleRadios1">Populate dropdown list</label>
                    </div>
                    <div class="alert alert-primary loader d-none" role="alert">
                        Please wait while we fetch data...
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4">
                    <div class="form-group">
                        <select required class="form-control" id="list1" name="list1" disabled>
                            <option value="">Please Select</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="form-group">
                        <select required class="form-control" id="list2" name="list2" disabled>
                            <option value="">Please Select</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="form-group">
                        <select required class="form-control" id="list3" name="list3" disabled>
                            <option value="">Please Select</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4">
                    <div class="form-group">
                        <label for="name">Name</label>
                        <div>
                            <input type="text" class="form-control" name="name" id="name" placeholder="Please Enter your name" pattern="[A-Za-z ]{2,15}"
                                title="Alphanumeric character min 2 max 15" maxlength="15" disabled />
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="form-group">
                        <label for="name">Mobile</label>
                        <div>
                            <input type="tel" class="form-control" name="mobile" id="mobile" placeholder="Please Enter your ph number" pattern="[0-9]{10}"
                                title="Phone Number" maxlength="10" disabled />
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="form-group">
                        <input type="button" disabled id="btnSubmit" value="Submit" class="btn btn-primary" />
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="dragPart" class="row d-none">
        <div class="col-md-12">
            <h2>Select a Plan</h2>
            <div class="row">
                <div class="col-md-6 col-xs-12">
                    <div id="div1" class="card bg-faded mb-2 p-3" ondrop="drop(event,1)" ondragover="dragOver(event)">
                    </div>
                </div>
                <div class="col-md-6 col-xs-12">
                    <div id="div2" class="card bg-faded mb-3 p-3" ondrop="drop(event,2)" ondragover="dragOver(event)">
                    </div>
                    <div class="form-group">
                        <input type="button" id="btnSelectPlan" value="Select Plan" class="btn btn-primary" />
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Modal title</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
            </div>
            <div class="modal-body">
                <p>Modal body text goes here.</p>
                <p id="msg"></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary">OK</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

#btnSubmit {
    margin-top: 32px;
}
#div1,
#div2 {
    min-height: 300px;
}

/* app.js */
$(function () {
    $("#appContainer").load('./content.html');

    $("body").on("click", "#exampleRadios1", function () {
        // CHANGE THE APIs AS PER REQUIREMENT
        populateList('list1', 'https://api.myjson.com/bins/vg53m');
        populateList('list2', 'https://api.myjson.com/bins/vg53m');
        populateList('list3', 'https://api.myjson.com/bins/vg53m');
    });

    $("body").on("click", "#btnSubmit", function () {
        ValidateForm();
    });

    $("body").on("click", "#btnSelectPlan", function () {
        submitForm();
    });
});

function populateList(id, url) {
    $.ajax({
        type: "GET",
        crossdomain: true,
        url: "https://api.myjson.com/bins/vg53m",
        beforeSend: function () {
            $('.loader').removeClass('d-none');
        },
        complete: function () {
            $('.loader').addClass('d-none');
        },
        success: function (resp, status) {
            $('#' + id).find('option').remove();
            $('#' + id).append($('<option>', {
                'value': '',
                'text': 'Please Select'
            }));
            $.each(resp, function (i, item) {
                $('#' + id).append($('<option>', {
                    'value': item.value,
                    'text': item.text
                }));
            });
            $("#btnSubmit, select, input[type='text'], input[type='tel']").removeAttr("disabled");
        },
        error: function (resp, status) {

        }
    });
}

function ValidateForm() {
    if ($('#list1').val() == '') {
        alert('Please select value from list1');
        return false;
    }
    if ($('#list2').val() == '') {
        alert('Please select value from list2');
        return false;
    }
    if ($('#list3').val() == '') {
        alert('Please select value from list3');
        return false;
    }
    var regex = /^[A-Za-z0-9\s]{2,15}$/;
    if (!regex.test($('#name').val())) {
        alert('Please Enter alphanumeric character for name min 2 max 15');
        return false;
    }

    regex = /^[0-9]{10}$/;
    if (!regex.test($('#mobile').val())) {
        alert('Please Enter your ph number(10 digit)');
        return false;
    }

    $('#formPart').addClass("d-none");
    $('#dragPart').removeClass("d-none");

    getPlanValues();
}

function getPlanValues() {
    $('#div1').html('');
    $('#div2').html('');
    $.ajax({
        type: "GET",
        crossdomain: true,
        url: "https://api.myjson.com/bins/19br7m",
        success: function (resp, status) {
            $.each(resp, function (i, item) {
                var div = '<div class="drag card mb-1" style="width: 18rem;" draggable="true" ondragstart="dragStart(event)" data-name="' + item.name + '" id="' + i + '" data-value="' + item.value + '"><div class="card-body"><h5 class="card-title text-uppercase">' + item.name + '</h5><h6 class="card-subtitle mb-2 text-muted"> Rs. ' + item.value + '</h6></div></div>';
                $('#div1').append(div);
            });
        },
        error: function (resp, status) {

        }
    });
}

function drop(e, type) {
    var div = e.dataTransfer.getData("text");
    if (type == 2 && $('#div2').find('.drag').length >= 1) {
        return false;
    }
    if (e.target.id !== 'div1' && e.target.id !== 'div2')
        return false;
    e.target.append(document.getElementById(div));
}

function dragOver(e) {
    e.preventDefault();
}

function dragStart(e) {
    e.dataTransfer.setData("text", e.target.id);
}

function submitForm() {
    var data = {
        "name": $('#name').val(),
        "mobile": $('#mobile').val(),
        "list1": $('#list1').val(),
        "list2": $('#list2').val(),
        "list3": $('#list3').val(),
        "div_val": {
            "name": $($('#div2').find('.drag')[0]).data("name"),
            "value": $($('#div2').find('.drag')[0]).data("value")
        }
    };

    $.ajax({
        type: "GET", // POST
        url: "https://api.myjson.com/bins/19br7m",
        crossdomain: true,
        contentType: "application/json",
        data: JSON.stringify(data),
        success: function (resp, status) {
            // console.log(resp);
            $('#myModal').find('#msg').html(JSON.stringify(data, null, 4));
            $('#myModal').modal('show');
        },
        error: function (resp, status) {
            // console.log(resp);
            $('#myModal').find('#msg').html(JSON.stringify(data, null, 4));
        }
    });
}


/* server.js */
/*
const express = require('express')
const app = express()

app.use(express.static('public'));
app.use(express.static('images'));

app.get('/', (req, res) => res.send('Hello World!'))

app.listen(3000, () => console.log('Example app listening on port 3000!'))
*/



<!--INSURANCE-->
<div class="container-fluid insuranceContainer">
    <!-- Here you need to design the new insurance and renew insurance containers using html, bootstrap and custom css classes. -->
    <div class="container">
        <div id="mainPart" class="row">
            <div class="col-md-8 col-xs-12">
                <div class="greyBG">
                    <div class="row mb-2">
                        <div class="col-md-12">
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios1" value="option1" />
                                <label class="form-check-label" for="exampleRadios1">Get New Insurance</label>
                            </div>
                            <div class="alert alert-primary loader d-none" role="alert">
                            Please wait while we fetch data...
                            </div>
                        </div>
                    </div>

                    <div id="formPart">
                        <div class="row">
                            <div class="col-md-4 col-xs-12">
                                <div class="form-group">
                                    <label for="ddCarType">Select a Car Type</label>
                                    <select required class="form-control" id="ddCarType" name="ddCarType" disabled>
                                        <option value="">Please Select</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4 col-xs-12">
                                <div class="form-group">
                                    <label for="ddFuelType">Select a Fuel Type</label>
                                    <select required class="form-control" id="ddFuelType" name="ddFuelType" disabled>
                                        <option value="">Please Select</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4 col-xs-12">
                                <div class="form-group">
                                    <label for="ddRegistrationState">Select a State</label>
                                    <select required class="form-control" id="ddRegistrationState" name="ddRegistrationState" disabled>
                                        <option value="">Please Select</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4 col-xs-12">
                                <div class="form-group">
                                    <label for="txtUserName">Enter Your Name</label>
                                    <div>
                                        <input type="text" class="form-control" name="txtUserName" id="txtUserName" placeholder="Please enter your name" pattern="[A-Za-z\s]{2,15}" title="Enter Name min 2 max 15" maxlength="15" disabled />
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 col-xs-12">
                                <div class="form-group">
                                    <label for="txtPhoneNumber">Enter Your Mobile Number</label>
                                    <div>
                                        <input type="tel" class="form-control" name="txtPhoneNumber" id="txtPhoneNumber" placeholder="Please enter your phone number" pattern="[0-9]{10}" title="Phone Number" maxlength="10" disabled />
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 col-xs-12">
                                <div class="form-group">
                                    <input type="button" disabled id="btnSubmit" value="Get Quotes" class="btn btn-primary btn-block" />
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="dragPart" class="row d-none">
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-4 col-xs-12">
                                    <div id="div1" class="card bg-faded mb-2 p-1 whiteBG" ondrop="drop(event,1)" ondragover="dragOver(event)">
                                        <p class="mb-1">Insurance Plan</p>
                                    </div>
                                </div>
                                <div class="col-md-4 col-xs-12">
                                    <div id="div2" class="card bg-faded mb-3 p-1 whiteBG" ondrop="drop(event,2)" ondragover="dragOver(event)">
                                        <p class="mb-1">To buy, drop your insurance policy here</p>
                                    </div>
                                </div>
                                <div class="col-md-4 col-xs-12">
                                    <div class="form-group">
                                        <input type="button" id="btnSelectPlan" value="Buy Insurance" class="btn btn-primary" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4 col-xs-12 right-col">
                <div class="greyBG">
                    <ul>
                        <li><strong>Benefits</strong></li>
                        <li>Easy</li>
                        <li>Efficient</li>
                        <li>Quick</li>
                    </ul>
                </div>
            </div>
        </div>        

        <!-- Modal -->
        <div class="modal fade" id="myModal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
        <div class="modal-content">
        <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
        </button>
        </div>
        <div class="modal-body">
        <div id="msg"></div>
        </div>
        </div>
        </div>
        </div>
    </div>
</div>

/* This body will cover you the whole background image css */
body{
background: url(/images/car.jpg)  no-repeat center center fixed;

-webkit-background-size: cover;
  -moz-background-size: cover;
  -o-background-size: cover;
  background-size: cover;

}

/* This is the div for the Main Container Parent <div> */
.insuranceContainer {
    margin-top: 30px;
    margin-left: 20px;
}

.headerDiv {
    background-color: #adadad;
    height: 60px;
    padding-top: 10px;
}

.logo {
    background: url("../images/sample_logo.png");
    height: 50px;
    width: 50px;
    margin-left: 15px;

}

.footerDiv {
    background-color: #adadad;
    height: 40px;
    padding-top: 10px;
    text-align: center;
    margin-top: 50px;
}
/* This is the class selector for InsuranceFormContainer that is div for the formconatiner  */
.insuranceFormContainer {
    background: #F0F0F0;
    margin-top: 45px;
   /*  padding-top:50px; */
    padding-bottom:50px;
    margin-right: 40px;
    box-shadow: 0px 3px 3px #BBBBBB;
}
/* This is the class selector for benefitsconatiner that is our second box in HTML */
.benefitsContainer {

    background: #F0F0F0;
    margin-top: 39px;
    margin-right: 40px;
    padding-top:45px;
    box-shadow: 0px 3px 3px #BBBBBB;
    text-align: center;
    padding-bottom:50px;
    
}
/* This is the class selector for all the div's in the Html i.e., only InsuranceRow */
.insuranceRow {
    height: 75px;
    padding-top: 10px;
}
/* This is the class selector for the second Box in the html i.e.,only BenefitsRow */
.benefitsRow {
    height: 50px;
    padding-top: 10px;
    text-align: center;
}

/* This is the class selector for all the Input edit text elements  */
.fieldInsurance {
    width: 95%;
    margin-left: 20px;
}
/* This is the class selector for renewInsurance edit text Field */
.fieldRenew {
    width: 150px;
    height: 33px;
}
/* This is the class selector for div element for the renewInsurance field */
.divRenew {
    padding-top: 20px;
    padding-bottom: 20px;
}

.detailsCol div label {
    font-weight: 300;
}
/* This is the  selector for the div GetQuotes */
.get-quotes{
    background: #ddd;
}
/*This is the class selector for the box conatiner div where we drag and drop the elements  */
.box-container {
    height: 200px;
}

.box-item {
    width: 100%;
    z-index: 1000
}
/* This is the class selector for buying the insurance div */
.colBuyIns {
    padding-top: 90px;
}
/* This is the class selector for div quotes panel where we are doing drag and drop*/
.quotesPanel {
    padding-bottom: 50px;
}
/* Class selector for the div failuremessage div error scenario */
.failureMessageDiv {
    color: red;
    font-weight: 700;
}
/* Class selector for the div Validation error for getting the errors in the redcolor statements */
.validationError {
    color: red;
}

.validationHighlight {
    border-color: red;
}

/* The Modal (background) */
.modal {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1050; /* Sit on top */
    padding-top: 100px; /* Location of the box */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    overflow: auto; /* Enable scroll if needed */
    background-color: rgb(0,0,0); /* Fallback color */
    background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}

/* Modal Content */
.modal-content {
    background-color: #fefefe;
    margin: auto;
    padding: 20px;
    border: 1px solid #888;
    width: 60%;
}

/* The Close Button */
.close {
    color: #aaaaaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
}

.close:hover,
.close:focus {
    color: #000;
    text-decoration: none;
    cursor: pointer;
}

#modelContent {
    color: green;
    font-weight: 700;
}
/* Class selector for making the proper adjustments between two boxes */
.row{
    margin-right:auto;
    margin-left:5px;
margin-bottom:20px;

}

.col-md-3{
padding-top:.5em;
padding-bottom:.5em;
}

.col-md-6 Tashan{
display:block;
}

.Fan{
position: fixed;
    top: 0;
    z-index: 10;
}    
    

.d-none {
    display: none;
}
.mb-1 {
    margin-bottom: 1em
}
.mb-2 {
    margin-bottom: 2em
}
.p-1 {
    padding: 1em;
}
.p-3 {
    padding: 3em;
}
.whiteBG {
    background: #fff;
}
#mainPart {
    margin-top: 3em
}

.greyBG {
    background: #ebebeb;
    padding: 20px;
    border-radius: 5px;
}

#btnSubmit {
  margin-top: 25px;
}

#div1,
#div2 {
  min-height: 300px;
}

.card {
    border: 1px solid #2e2e2e;
    border-radius: 5px;
}


/* css Code for responsive table   */
@media only screen and (max-width: 800px) {
    
    /* Force table to not be like tables anymore */
    #no-more-tables table, 
    #no-more-tables thead, 
    #no-more-tables tbody, 
    #no-more-tables th, 
    #no-more-tables td, 
    #no-more-tables tr { 
        display: block; 
    }
 
    /* Hide table headers (but not display: none;, for accessibility) */
    #no-more-tables thead tr { 
        position: absolute;
        top: -9999px;
        left: -9999px;
    }
 
    #no-more-tables tr { border: 1px solid #ccc; }
 
    #no-more-tables td { 
        /* Behave  like a "row" */
        border: none;
        border-bottom: 1px solid #eee; 
        position: relative;
        padding-left: 50%; 
        white-space: normal;
        text-align:left;
    }
 
    #no-more-tables td:before { 
        /* Now like a table header */
        position: absolute;
        /* Top/left values mimic padding */
        top: 6px;
        left: 6px;
        width: 45%; 
        padding-right: 10px; 
        white-space: nowrap;
        text-align:left;
        font-weight: bold;
    }
    .right-col {
        margin-top: 10px;
    }
 
    /*
    Label the data
    */
    #no-more-tables td:before { content: attr(data-title); }



    // Handle all the logics once the document is ready
$(document).ready(function() {
    // here you need to handle and implement all the logics for new insurance and renew insurance requirements.
    // Try to leverange the power of jQuery to do the DOM manipulation to achieve the requirements.
    // id "#insurance" in index.html should load the insurance template on DOM ready
  $("#insurance").load('./views/insurance.html');

  $("body").on("click", "#exampleRadios1", function() {
    populateList('ddCarType', 'http://localhost:3000/api/common/getCarModels');
    populateList('ddFuelType', 'http://localhost:3000/api/common/getFuelType');
    populateList('ddRegistrationState', 'http://localhost:3000/api/common/getRegStateCodes');
  });

  $("body").on("click", "#btnSubmit", function() {
    ValidateForm();
  });

  $("body").on("click", "#btnSelectPlan", function() {
    submitForm();
  });
});

function populateList(id, url) {
  $.ajax({
    type: "GET",
    crossdomain: true,
    url: url,
    beforeSend: function() {
      $('.loader').removeClass('d-none');
    },
    complete: function() {
      $('.loader').addClass('d-none');
    },
    success: function(resp, status) {
      $('#' + id).find('option').remove();
      $('#' + id).append($('<option>', {
        'value': '',
        'text': 'Please Select'
      }));

      $.each(resp.data, function(i, item) {
        $('#' + id).append($('<option>', {
          'value': i,
          'text': item
        }));
      });
      $("#btnSubmit, select, input[type='text'], input[type='tel']").removeAttr("disabled");
    },
    error: function(resp, status) {

    }
  });
}

function ValidateForm() {
  if ($('#ddCarType').val() == '') {
    alert('Please select Car Type');
    return false;
  }
  if ($('#ddFuelType').val() == '') {
    alert('Please select Fuel Type');
    return false;
  }
  if ($('#ddRegistrationState').val() == '') {
    alert('Please select Registration State');
    return false;
  }
  var regex = /^[A-Za-z\s]{2,15}$/;
  if (!regex.test($('#txtUserName').val())) {
    alert('Please Enter a valid name with minimum 2 and maximum 15 characters.');
    return false;
  }

  regex = /^[0-9]{10}$/;
  if (!regex.test($('#txtPhoneNumber').val())) {
    alert('Please Enter a valid mobile number(10 digit)');
    return false;
  }

  $('#formPart').addClass("d-none");
  $('#dragPart').removeClass("d-none");

  getPlanValues();
}

function getPlanValues() {
  $.ajax({
    type: "GET",
    crossdomain: true,
    url: "http://localhost:3000/api/getQuotes",
    success: function(resp, status) {
      $.each(resp.data, function(i, item) {
        var div = '<div class="drag card mb-1 p-1" draggable="true" ondragstart="dragStart(event)" data-name="' + item.name + '" id="' + i + '" data-price="' + item.price + '"><div class="card-body"><h5 class="card-title text-uppercase">' + item.name + '</h5><h6 class="card-subtitle mb-2 text-muted"> Rs. ' + item.price + '</h6></div></div>';
        $('#div1').append(div);
      });
    },
    error: function(resp, status) {

    }
  });
}

function drop(e, type) {
  var div = e.dataTransfer.getData("text");
  if (type == 2 && $('#div2').find('.drag').length >= 1) {
    return false;
  }
  if (e.target.id !== 'div1' && e.target.id !== 'div2')
    return false;
  e.target.append(document.getElementById(div));
}

function dragOver(e) {
  e.preventDefault();
}

function dragStart(e) {
  e.dataTransfer.setData("text", e.target.id);
}

function submitForm() {
  var data = {
    "userName": $('#txtUserName').val(),
    "phoneNumber": $('#txtPhoneNumber').val(),
    "carType": $('#ddCarType').val(),
    "fuelType": $('#ddFuelType').val(),
    "registrationState": $('#ddRegistrationState').val(),
    "plan": {
      "name": $($('#div2').find('.drag')[0]).data("name"),
      "price": $($('#div2').find('.drag')[0]).data("price")
    }
  };

  $.ajax({
    type: "POST",
    url: "http://localhost:3000/api/addInsurance",
    crossdomain: true,
    contentType: "application/json",
    data: JSON.stringify(data),
    success: function(resp, status) {
      $('#myModal').find('#msg').html("<p class='text-success'><strong>You have successfully bought the insurance. Your policy number is " + resp.data.policyNumber + ".</strong></p>");
      $('#myModal').modal('show');
    },
    error: function(resp, status) {
      
    }
  });
}

